<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
    <title>Билюкин С.К. ПИ19-1</title>
</head>
<body>

<div style="display: flex; flex-direction: column; width: 100%; height: 100vh; align-items: center">
    <form class="row gy-2 gx-3 align-items-center" style="position: absolute; width: 100%; justify-content: center; margin-top: 30px; z-index: 2;" id="form">
            <div class="row gx-3 justify-content-center">
                <div class="col-8">
                    <div class="row">
                        <div class="col-6">
                            <input class="form-control" type="text" name="pointFrom" placeholder="Откуда" required>
                        </div>
                        <div class="col-6">
                            <input class="form-control" type="text" name="pointTo" placeholder="Куда" required>
                        </div>
                    </div>
                    <div class="row mt-2">
                        <div class="col-6" role="group" aria-label="Basic radio toggle button group">
                            <input type="radio" class="btn-check" name="routingMode" id="btnradio1" autocomplete="off" value="auto" checked>
                            <label class="btn btn-outline-primary" for="btnradio1"><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M20 18.5v-5.014c0-.357-.059-.702-.168-1.025l-1.403-5.33a2.56 2.56 0 0 0-2.195-1.893C14.79 5.079 14.045 5 12 5s-2.79.08-4.233.238A2.56 2.56 0 0 0 5.57 7.13l-1.403 5.33C4.06 12.784 4 13.13 4 13.486V18.5a.5.5 0 0 0 .5.5h2.11a.5.5 0 0 0 .485-.379L7.5 17h9l.405 1.621a.5.5 0 0 0 .486.379h2.11a.5.5 0 0 0 .5-.5zm-4.2-12c.624.09 1.173.53 1.337 1.154L18 10.7c-.318-.169-1.026-.326-1.401-.378C15.058 10.107 13.978 10 12 10c-1.979 0-3.056.107-4.597.322-.375.052-1.085.209-1.403.378l.862-3.046C7.026 7.029 7.576 6.59 8.2 6.5c1.404-.201 1.79-.232 3.8-.232 2.011 0 2.395.031 3.8.232zm1.7 8.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3zM8 13.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z" fill="currentColor"></path><path d="M21.5 9a.5.5 0 0 1 .5.5v.408a1 1 0 0 1-.886.993l-.428.05a.5.5 0 0 1-.542-.376l-.238-.954A.5.5 0 0 1 20.39 9H21.5z" fill="currentColor"></path><path d="M2.5 9a.5.5 0 0 0-.5.5v.408a1 1 0 0 0 .886.993l.428.05a.5.5 0 0 0 .542-.376l.239-.954A.5.5 0 0 0 3.61 9H2.5z" fill="currentColor"></path></svg></label>

                            <input type="radio" class="btn-check" name="routingMode" id="btnradio2" autocomplete="off" value="masstransit">
                            <label class="btn btn-outline-primary" for="btnradio2"><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M19 11v8.5a.5.5 0 0 1-.5.5h-2.11a.5.5 0 0 1-.485-.379L15.5 18h-7l-.405 1.621A.5.5 0 0 1 7.61 20H5.5a.5.5 0 0 1-.5-.5V11l-.724-.362A.5.5 0 0 1 4 10.191V8a1 1 0 0 1 1-1v-.612a2 2 0 0 1 1.382-1.902C7.411 4.152 9.255 4 12 4s4.59.152 5.618.486A2 2 0 0 1 19 6.388V7a1 1 0 0 1 1 1v2.191a.5.5 0 0 1-.276.447L19 11zm-7-5c-2.254 0-3.96.238-5.12.715a1 1 0 0 0-.617.86L6 11.618a.5.5 0 0 0 .424.494c.812.125 2.671.188 5.576.188s4.764-.063 5.576-.188a.5.5 0 0 0 .424-.494l-.263-4.043a1 1 0 0 0-.617-.86C15.96 6.238 14.254 6 12 6zm4.5 11a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3zm-9 0a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z" fill="currentColor"></path></svg></label>

                            <input type="radio" class="btn-check" name="routingMode" id="btnradio3" autocomplete="off" value="pedestrian">
                            <label class="btn btn-outline-primary" for="btnradio3"><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M14 4.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z" fill="currentColor"></path><path d="M14.836 15.133a.66.66 0 0 1 .11.217l1.4 4.734a.716.716 0 0 1-.516.889.76.76 0 0 1-.909-.447l-1.672-4.413-2.815-2.707a1.013 1.013 0 0 1-.29-.93l.6-3.292-1.352.385-1.191 2.664a.635.635 0 0 1-.82.32.593.593 0 0 1-.34-.766L8.242 8.78a.626.626 0 0 1 .308-.332l.077-.037 3.008-1.478.021-.008.015-.005a.935.935 0 0 1 .6-.089c.269.05.5.199.615.425.114.226.154.641.154.641.046.256.062.508.078.76a12.356 12.356 0 0 1 .039 1.42c-.021.72-.07 1.434-.17 2.141l-.053.418 1.833 2.407.068.091z" fill="currentColor"></path><path d="M14.12 9.253l2.643 2.276c.27.206.316.583.103.843a.644.644 0 0 1-.858.114l-2.128-1.482.023-.129.028-.158.074-.407.026-.145.025-.142.017-.23.025-.29.01-.12.011-.13z" fill="currentColor"></path><path d="M10.164 14.399c.209.2.441.405.674.609.371.326.751.64 1.085.895-.142.287-.379.76-.379.76l-2.539 3.992a.768.768 0 0 1-1.031.24.707.707 0 0 1-.278-.943l2.117-3.99.029-.277c.023-.225.046-.451.077-.675l.11-.736.065.06.07.065z" fill="currentColor"></path></svg></label>

                            <input type="radio" class="btn-check" name="routingMode" id="btnradio4" autocomplete="off" value="bicycle">
                            <label class="btn btn-outline-primary" for="btnradio4"><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8.138 10.287l-.953.318A.9.9 0 0 1 6 9.751v-.597c0-.401.042-.547.12-.694a.818.818 0 0 1 .34-.34c.147-.078.293-.12.694-.12H9.75a.75.75 0 0 1 .75.75v.007c0 .173-.025.319-.075.445a.807.807 0 0 1-.231.32 1.182 1.182 0 0 1-.399.213l-.205.068 2.277 3.961 3.318-5.53-.58-1.451a.45.45 0 0 0-.417-.283H12.75a.75.75 0 0 1 0-1.5h1.438a1.95 1.95 0 0 1 1.81 1.226l2.513 6.282a3.75 3.75 0 1 1-1.457.397l-1.169-2.923-3.083 5.14a1.79 1.79 0 0 1 .398 1.128 1.798 1.798 0 0 1-2.194 1.753L5.688 16.8a.563.563 0 0 1 0-1.098l4.92-1.115-2.471-4.299zm.233 3.884l-1.653.374a2.25 2.25 0 1 0 0 3.41l1.653.374a3.75 3.75 0 1 1 0-4.159zM21 16.25a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0z" fill="currentColor"></path></svg></label>

                        </div>
                    </div>
                </div>
                <div class="col-auto">
                    <button type="submit" class="btn btn-primary btn-sm">Построить маршрут</button>
                    <button type="button" class="btn btn-danger btn-sm mx-1" style="margin-left: 15px" onclick="clearMap()">Очистить карту</button>
                </div>
            </div>
    </form>
    <div id="map" style="width: 100%; height: 100%; z-index: 1"></div>
</div>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
<script src="https://api-maps.yandex.ru/2.1/?apikey=44b33967-4f20-4a6c-983a-baca76b06acb&lang=ru_RU" type="text/javascript"></script>
<script type="text/javascript">
    var myMap;
    var myRoute;
    ymaps.ready(init);
    function init() {
        const location = ymaps.geolocation;
        myMap = new ymaps.Map("map", {
            // По умолчанию Зеленоград
            center: [55.99, 37.21],
            zoom: 11,
            controls: ['zoomControl', 'typeSelector'],
        });

        location.get({
            provider: 'yandex',
            mapStateAutoApply: true,
        }).then((result) => {
            if (result.geoObjects.position) {
                myMap.setCenter(result.geoObjects.position, 11);
            } else {
                location.get({
                    provider: 'browser',
                    mapStateAutoApply: true,
                }).then((result) => {
                    myMap.setCenter(result.geoObjects.position, 11);
                });
            }
        });
    }


    const makeRoute = ({pointFrom, pointTo, routingMode}) => {
        clearMap();
        myRoute = new ymaps.multiRouter.MultiRoute({
            referencePoints: [
                pointFrom,
                pointTo,
            ],
            params: {
                avoidTrafficJams: true,
                routingMode: routingMode,
            }
        }, {
            boundsAutoApply: true
        });

        myMap.geoObjects.add(myRoute);

        myRoute.model.events.add('requestsuccess', () => {
            const activeRoute = myRoute.getActiveRoute();
            activeRoute.balloon.open()
        })
    }

    const clearMap = () => {
      myMap.geoObjects.removeAll();
    }

    const form = document.getElementById('form');

    form.onsubmit = async (e) => {
        e.preventDefault();
        const formData = new FormData(form);
        makeRoute(Object.fromEntries(formData));
    }
</script>
</body>
</html>